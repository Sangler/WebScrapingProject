<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/index.css" type="text/css">
    <title>OTP Page</title>
    <style>

h2 {
    margin-bottom: 20px;
    color: #333;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* OTP input styles */
.email-otp-container,.btn-container {
    display: flex;
    justify-content: center;
    margin-top: 20px;
}

 .email-otp-input {
    width: 40px;
    height: 40px;
    text-align: center;
    font-size: 18px;
    margin: 0 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
    outline: none;
    transition: border-color 0.3s;
}

.otp-input:focus, .email-otp-input:focus {
    border-color: #007bff;
}

.email-otp {
    margin-top: 25px;

}
/* Button styles */
button {
    margin-top: 15px;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
}

button:hover {
    background-color: #0056b3;
}
    </style>
</head>
<body>
  <%- include('../layout/header_unauth')%>
  <h2>Email OTP</h2>
  <form class="email-otp">

    <div class="email-otp-container">
        <!-- Six input fields for OTP digits -->
        <input type="text" class="email-otp-input" pattern="\d" maxlength="1">
        <input type="text" class="email-otp-input" pattern="\d" maxlength="1" disabled>
        <input type="text" class="email-otp-input" pattern="\d" maxlength="1" disabled>
        <input type="text" class="email-otp-input" pattern="\d" maxlength="1" disabled>
        <input type="text" class="email-otp-input" pattern="\d" maxlength="1" disabled>
        <input type="text" class="email-otp-input" pattern="\d" maxlength="1" disabled>
    </div>
      <div class="btn-container">
      <button type="button" id="verifyEmailOTP">VERIFY EMAIL</button>
    </div>
  </form>

  <script src="../js/event.js"></script>

<script>
  // https://codepen.io/Rajesh-Pal-the-scripter/pen/gOZrbzK
    document.addEventListener("DOMContentLoaded", () => {  
  var emailOtpInputs = document.querySelectorAll(".email-otp-input");
  function setupOtpInputListeners(inputs) {
    inputs.forEach(function (input, index) {
      input.addEventListener("paste", function (ev) {
        var clip = ev.clipboardData.getData("text").trim();
        if (!/^\d{6}$/.test(clip)) {
          ev.preventDefault();
          return;
        }

        var characters = clip.split("");
        inputs.forEach(function (otpInput, i) {
          otpInput.value = characters[i] || "";
        });

        enableNextBox(inputs[0], 0);
        inputs[5].removeAttribute("disabled");
        inputs[5].focus();
        updateOTPValue(inputs);
      });

      input.addEventListener("input", function () {
        var currentIndex = Array.from(inputs).indexOf(this);
        var inputValue = this.value.trim();

        if (!/^\d$/.test(inputValue)) {
          this.value = "";
          return;
        }

        if (inputValue && currentIndex < 5) {
          inputs[currentIndex + 1].removeAttribute("disabled");
          inputs[currentIndex + 1].focus();
        }

        if (currentIndex === 4 && inputValue) {
          inputs[5].removeAttribute("disabled");
          inputs[5].focus();
        }

        updateOTPValue(inputs);
      });

      input.addEventListener("keydown", function (ev) {
        var currentIndex = Array.from(inputs).indexOf(this);

        if (!this.value && ev.key === "Backspace" && currentIndex > 0) {
          inputs[currentIndex - 1].focus();
        }
      });
    });
  }

  function updateOTPValue(inputs) {
    var otpValue = "";
    inputs.forEach(function (input) {
      otpValue += input.value;
    });

    if (inputs === otpInputs) {
      document.getElementById("verificationCode").value = otpValue;
    } else if (inputs === emailOtpInputs) {
      document.getElementById("emailverificationCode").value = otpValue;
    }
  }

  // Setup listeners for OTP inputs
  setupOtpInputListeners(emailOtpInputs);

  // Add event listener for verify button
  document.getElementById("verifyEmailOTP").addEventListener("click", function () {
    var otpValue = document.getElementById("emailverificationCode").value;
    alert("Submitted Email OTP: " + otpValue);
    // Add your submit logic here
  });
  emailOtpInputs[0].focus();

      });
</script>

</body>

</html>